<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Calculadora de Recursos e Valor ‚Äî Jogo</title>
  <style>
    :root{
      --bg:#0b1220; --card:#071022; --panel:#0e1a2b; --accent:#06b6d4; --accent2:#34d399;
      --text:#e6eef8; --muted:#9fb1c8; --glass: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    body{
      margin:0; min-height:100vh; display:flex; align-items:center; justify-content:center;
      font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background: linear-gradient(180deg,#031022 0%, #071228 100%);
      color:var(--text); padding:28px;
    }
    .wrap{ width:100%; max-width:980px; }
    header{ display:flex; align-items:center; gap:14px; margin-bottom:18px; }
    header h1{ margin:0; font-size:20px; }
    header p{ margin:0; color:var(--muted); font-size:13px; }
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.03);
      padding:18px; border-radius:12px; box-shadow:0 10px 30px rgba(2,6,23,0.6);
    }
    .grid{ display:grid; grid-template-columns: 1fr 360px; gap:16px; }
    @media (max-width:900px){ .grid{ grid-template-columns: 1fr; } }
    .left{ padding-right:6px; }
    .ammo-row{ display:flex; gap:10px; align-items:center; margin-bottom:12px; }
    .ammo-card{
      background:var(--panel); padding:12px; border-radius:10px; flex:1; border:1px solid rgba(255,255,255,0.02);
    }
    label{ display:block; font-size:13px; color:var(--muted); margin-bottom:6px; }
    input[type="number"]{
      width:100%; padding:10px 12px; border-radius:8px; border:1px solid rgba(255,255,255,0.04);
      background:transparent; color:var(--text); font-size:15px;
    }
    .small{ font-size:13px; color:var(--muted); }
    .presets{ display:flex; gap:8px; margin-top:8px; flex-wrap:wrap; }
    .btn{ background:var(--accent); color:#042028; padding:8px 10px; border-radius:9px; border:none; cursor:pointer; font-weight:600; }
    .btn-outline{ background:transparent; border:1px solid rgba(255,255,255,0.04); color:var(--text); padding:8px 10px; border-radius:9px; cursor:pointer; }
    .controls{ display:flex; gap:8px; margin-top:10px; align-items:center; flex-wrap:wrap; }
    .result{
      background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
      border-radius:10px; padding:14px; margin-bottom:12px; border:1px solid rgba(255,255,255,0.03);
    }
    .result h3{ margin:0 0 6px 0; font-size:16px; display:flex; align-items:center; gap:8px; }
    .totals{ display:grid; grid-template-columns: repeat(3,1fr); gap:10px; margin-top:10px; }
    .total-item{ background:rgba(255,255,255,0.02); padding:8px; border-radius:8px; text-align:center; }
    .total-item strong{ display:block; font-size:18px; }
    footer{ margin-top:10px; color:var(--muted); font-size:13px; display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap; }
    .toggle{ display:flex; gap:8px; align-items:center; }
    .copy-btn{ background:var(--accent2); color:#042018; padding:8px 10px; border-radius:9px; border:none; cursor:pointer; font-weight:700; }
    .note{ margin-top:8px; color:var(--muted); font-size:13px; }
    /* Nova se√ß√£o de valor */
    .price-card{ margin-top:14px; background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005)); padding:12px; border-radius:10px; border:1px solid rgba(255,255,255,0.02); }
    .price-row{ display:flex; gap:8px; align-items:center; margin-bottom:8px; }
    .price-row input[type="number"]{ max-width:120px; }
    .price-totals{ margin-top:10px; display:grid; grid-template-columns: 1fr 1fr; gap:8px; }
    .price-item{ background:rgba(255,255,255,0.02); padding:10px; border-radius:8px; text-align:left; }
    .muted-italic{ color:var(--muted); font-size:13px; font-style:italic; }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div>
        <h1>Calculadora de Recursos e Valor ‚Äî Jogo</h1>
        <p class="small">Insira quantas muni√ß√µes quer fabricar e obtenha recursos necess√°rios e o custo total (pre√ßos por unidade).</p>
      </div>
    </header>

    <div class="card grid">
      <div class="left">
        <!-- AMMO: Fuzil -->
        <div class="ammo-row">
          <div class="ammo-card">
            <label>üî´ Muni√ß√£o de Fuzil (por 1000 = 1000 Cobres, 1000 Alum√≠nios, 267 P√≥lvoras)</label>
            <input id="fuzilQty" type="number" min="0" step="1" value="0" />
            <div class="presets small" style="margin-top:8px">
              <button class="btn-outline" data-target="fuzil" data-value="1">+1</button>
              <button class="btn-outline" data-target="fuzil" data-value="10">+10</button>
              <button class="btn-outline" data-target="fuzil" data-value="100">+100</button>
              <button class="btn-outline" data-target="fuzil" data-value="1000">+1000</button>
            </div>
          </div>
        </div>

        <!-- AMMO: Sub -->
        <div class="ammo-row">
          <div class="ammo-card">
            <label>üî© Muni√ß√£o de Sub (por 1000 = 500 Cobres, 500 Alum√≠nios, 167 P√≥lvoras)</label>
            <input id="subQty" type="number" min="0" step="1" value="0" />
            <div class="presets small" style="margin-top:8px">
              <button class="btn-outline" data-target="sub" data-value="1">+1</button>
              <button class="btn-outline" data-target="sub" data-value="10">+10</button>
              <button class="btn-outline" data-target="sub" data-value="100">+100</button>
              <button class="btn-outline" data-target="sub" data-value="1000">+1000</button>
            </div>
          </div>
        </div>

        <!-- AMMO: Pistola -->
        <div class="ammo-row">
          <div class="ammo-card">
            <label>üî∏ Muni√ß√£o de Pistola (por 1000 = 500 Cobres, 500 Alum√≠nios, 100 P√≥lvoras)</label>
            <input id="pistolaQty" type="number" min="0" step="1" value="0" />
            <div class="presets small" style="margin-top:8px">
              <button class="btn-outline" data-target="pistola" data-value="1">+1</button>
              <button class="btn-outline" data-target="pistola" data-value="10">+10</button>
              <button class="btn-outline" data-target="pistola" data-value="100">+100</button>
              <button class="btn-outline" data-target="pistola" data-value="1000">+1000</button>
            </div>
          </div>
        </div>

        <div class="controls">
          <button id="calcBtn" class="btn">Calcular</button>
          <button id="clearBtn" class="btn-outline">Limpar</button>

          <label style="margin-left:6px;" class="small">
            <input id="ceilToggle" type="checkbox" checked /> Arredondar recursos para cima (inteiros)
          </label>

          <div style="margin-left:auto;">
            <button id="copyBtn" class="copy-btn">Copiar resumo</button>
          </div>
        </div>

        <p class="note">Dica: deixe o "Arredondar" ativado se no seu jogo recursos n√£o podem ser fracion√°rios.</p>

        <!-- SE√á√ÉO: Calculador de Valor -->
        <div class="price-card">
          <h3 style="margin:0 0 8px 0;">Calculador de Valor (pre√ßos por unidade)</h3>
          <div class="price-row">
            <label style="flex:1">
              <div class="small">Pre√ßo unit√°rio - Muni√ß√£o de Fuzil</div>
              <input id="priceFuzil" type="number" min="0" step="1" value="290" />
            </label>
            <label style="flex:1">
              <div class="small">Pre√ßo unit√°rio - Muni√ß√£o de Sub</div>
              <input id="priceSub" type="number" min="0" step="1" value="250" />
            </label>
            <label style="flex:1">
              <div class="small">Pre√ßo unit√°rio - Muni√ß√£o de Pistola</div>
              <input id="pricePistola" type="number" min="0" step="1" value="150" />
            </label>
          </div>

          <div style="display:flex; gap:8px; align-items:center; margin-top:8px;">
            <button id="calcPriceBtn" class="btn">Calcular Valor</button>
            <button id="resetPriceBtn" class="btn-outline">Resetar Pre√ßos</button>
            <div class="muted-italic" style="margin-left:auto;">Os pre√ßos podem ser alterados para simular mercado do jogo.</div>
          </div>

          <div class="price-totals" id="priceTotals" style="margin-top:10px;">
            <div class="price-item">
              <div class="small">Custo por tipo</div>
              <div id="costFuzil" style="font-weight:700; margin-top:6px;">R$ 0</div>
              <div class="small" id="costFuzilDetail"></div>
            </div>
            <div class="price-item">
              <div class="small">Custo total geral</div>
              <div id="grandTotal" style="font-weight:900; font-size:18px; margin-top:6px;">R$ 0</div>
              <div class="small" id="grandDetail"></div>
            </div>
          </div>
        </div>
      </div>

      <aside>
        <div class="result" id="resultPanel">
          <h3>Resumo r√°pido</h3>
          <div id="breakdown">
            <p class="small">Nenhuma quantidade calculada ainda.</p>
          </div>

          <div style="margin-top:12px">
            <strong class="small">Totais de recursos</strong>
            <div class="totals" id="totalsGrid">
              <div class="total-item">
                <div class="small">Cobres</div>
                <strong id="totalCobre">0</strong>
              </div>
              <div class="total-item">
                <div class="small">Alum√≠nios</div>
                <strong id="totalAlum">0</strong>
              </div>
              <div class="total-item">
                <div class="small">P√≥lvoras</div>
                <strong id="totalPulv">0</strong>
              </div>
            </div>
          </div>

          <footer>
            <div class="small">Base: valores por 1000 unidades (configurados no script).</div>
            <div class="small">Formato: inteiro se "Arredondar" ativo.</div>
          </footer>
        </div>
      </aside>
    </div>
  </div>

  <script>
    // Receitas por 1000 unidades (dados do usu√°rio)
    const RECIPES = {
      fuzil: { cobre: 1000, alum: 1000, pul: 267, label: 'Muni√ß√£o de Fuzil' },
      sub:   { cobre: 500,  alum: 500,  pul: 167, label: 'Muni√ß√£o de Sub' },
      pistola:{ cobre:500,  alum: 500,  pul: 100, label: 'Muni√ß√£o de Pistola' }
    };

    // PRE√áOS (inicializados conforme solicitado)
    // Esses campos s√£o edit√°veis na UI, com valores iniciais:
    // Fuzil = 290, Sub = 250, Pistola = 150
    const priceInputs = {
      fuzil: document.getElementById('priceFuzil'),
      sub: document.getElementById('priceSub'),
      pistola: document.getElementById('pricePistola')
    };

    // Helper: calcula por quantidade dada, usando regra direta (por 1000)
    function calcFor(recipe, qty, roundUp){
      const factor = qty / 1000;
      const raw = {
        cobre: recipe.cobre * factor,
        alum: recipe.alum * factor,
        pul: recipe.pul * factor
      };
      if(roundUp){
        return {
          cobre: Math.ceil(raw.cobre),
          alum: Math.ceil(raw.alum),
          pul: Math.ceil(raw.pul)
        };
      } else {
        return {
          cobre: +(raw.cobre.toFixed(2)),
          alum: +(raw.alum.toFixed(2)),
          pul: +(raw.pul.toFixed(2))
        };
      }
    }

    // DOM
    const fuzilQty = document.getElementById('fuzilQty');
    const subQty = document.getElementById('subQty');
    const pistolaQty = document.getElementById('pistolaQty');
    const calcBtn = document.getElementById('calcBtn');
    const clearBtn = document.getElementById('clearBtn');
    const ceilToggle = document.getElementById('ceilToggle');
    const breakdown = document.getElementById('breakdown');
    const totalCobre = document.getElementById('totalCobre');
    const totalAlum = document.getElementById('totalAlum');
    const totalPulv = document.getElementById('totalPulv');
    const copyBtn = document.getElementById('copyBtn');

    // Price DOM
    const calcPriceBtn = document.getElementById('calcPriceBtn');
    const resetPriceBtn = document.getElementById('resetPriceBtn');
    const costFuzil = document.getElementById('costFuzil');
    const costFuzilDetail = document.getElementById('costFuzilDetail');
    const grandTotal = document.getElementById('grandTotal');
    const grandDetail = document.getElementById('grandDetail');

    // Preset buttons (quantidades)
    document.querySelectorAll('.btn-outline[data-target]').forEach(btn=>{
      btn.addEventListener('click', ()=> {
        const target = btn.dataset.target;
        const value = parseInt(btn.dataset.value,10);
        if(target === 'fuzil'){
          fuzilQty.value = Number(fuzilQty.value || 0) + value;
        } else if(target === 'sub'){
          subQty.value = Number(subQty.value || 0) + value;
        } else if(target === 'pistola'){
          pistolaQty.value = Number(pistolaQty.value || 0) + value;
        }
      });
    });

    // Fun√ß√£o principal de c√°lculo de recursos
    function performCalc(){
      const qF = Math.max(0, Math.floor(Number(fuzilQty.value) || 0));
      const qS = Math.max(0, Math.floor(Number(subQty.value) || 0));
      const qP = Math.max(0, Math.floor(Number(pistolaQty.value) || 0));
      const roundUp = !!ceilToggle.checked;

      // calcular recursos por tipo
      const rF = calcFor(RECIPES.fuzil, qF, roundUp);
      const rS = calcFor(RECIPES.sub, qS, roundUp);
      const rP = calcFor(RECIPES.pistola, qP, roundUp);

      // Somar totais
      const sumCobre = (rF.cobre + rS.cobre + rP.cobre);
      const sumAlum  = (rF.alum + rS.alum + rP.alum);
      const sumPulv  = (rF.pul + rS.pul + rP.pul);

      // Mostrar detalhe
      breakdown.innerHTML = `
        <div class="small"><strong>Detalhes por tipo</strong></div>
        <div style="margin-top:8px;">
          <div style="margin-bottom:6px;"><strong>${RECIPES.fuzil.label}:</strong> ${qF} unidades ‚Üí Cobres ${rF.cobre}, Alum√≠nios ${rF.alum}, P√≥lvoras ${rF.pul}</div>
          <div style="margin-bottom:6px;"><strong>${RECIPES.sub.label}:</strong> ${qS} unidades ‚Üí Cobres ${rS.cobre}, Alum√≠nios ${rS.alum}, P√≥lvoras ${rS.pul}</div>
          <div style="margin-bottom:6px;"><strong>${RECIPES.pistola.label}:</strong> ${qP} unidades ‚Üí Cobres ${rP.cobre}, Alum√≠nios ${rP.alum}, P√≥lvoras ${rP.pul}</div>
        </div>
      `;

      // Totais (exibir como integer se roundUp)
      totalCobre.textContent = (roundUp ? Math.ceil(sumCobre) : sumCobre);
      totalAlum.textContent  = (roundUp ? Math.ceil(sumAlum)  : sumAlum);
      totalPulv.textContent  = (roundUp ? Math.ceil(sumPulv)  : sumPulv);

      // tamb√©m atualiza c√°lculo de pre√ßo se j√° houver valores
      computePrice(qF,qS,qP);
    }

    // C√°lculo de pre√ßo: usa pre√ßos unit√°rios * quantidade (pre√ßo configur√°vel)
    function computePrice(qF=null, qS=null, qP=null){
      // se quantidades n√£o foram passadas, l√™ das inputs
      qF = qF === null ? Math.max(0, Math.floor(Number(fuzilQty.value) || 0)) : qF;
      qS = qS === null ? Math.max(0, Math.floor(Number(subQty.value) || 0)) : qS;
      qP = qP === null ? Math.max(0, Math.floor(Number(pistolaQty.value) || 0)) : qP;

      const pF = Number(priceInputs.fuzil.value) || 0;
      const pS = Number(priceInputs.sub.value) || 0;
      const pP = Number(priceInputs.pistola.value) || 0;

      const costF = qF * pF;
      const costS = qS * pS;
      const costP = qP * pP;

      const grand = costF + costS + costP;

      // Formata em "R$" simples com separador de milhares
      function money(v){
        return 'R$ ' + v.toLocaleString('pt-BR');
      }

      costFuzil.textContent = money(costF);
      costFuzilDetail.textContent = `${qF} √ó ${pF.toLocaleString('pt-BR')} = ${money(costF)}`;

      // detalhe grand total
      grandTotal.textContent = money(grand);
      grandDetail.textContent = `${qF}√ó${pF.toLocaleString('pt-BR')} + ${qS}√ó${pS.toLocaleString('pt-BR')} + ${qP}√ó${pP.toLocaleString('pt-BR')} = ${money(grand)}`;

      return { costF, costS, costP, grand };
    }

    // Eventos
    calcBtn.addEventListener('click', performCalc);

    clearBtn.addEventListener('click', ()=>{
      fuzilQty.value = 0;
      subQty.value = 0;
      pistolaQty.value = 0;
      ceilToggle.checked = true;
      breakdown.innerHTML = '<p class="small">Nenhuma quantidade calculada ainda.</p>';
      totalCobre.textContent = '0';
      totalAlum.textContent = '0';
      totalPulv.textContent = '0';
      // zerar pre√ßos visuais (mas n√£o os inputs)
      costFuzil.textContent = 'R$ 0';
      costFuzilDetail.textContent = '';
      grandTotal.textContent = 'R$ 0';
      grandDetail.textContent = '';
    });

    copyBtn.addEventListener('click', ()=>{
      const qF = Math.max(0, Math.floor(Number(fuzilQty.value) || 0));
      const qS = Math.max(0, Math.floor(Number(subQty.value) || 0));
      const qP = Math.max(0, Math.floor(Number(pistolaQty.value) || 0));
      const roundUp = !!ceilToggle.checked;

      const rF = calcFor(RECIPES.fuzil, qF, roundUp);
      const rS = calcFor(RECIPES.sub, qS, roundUp);
      const rP = calcFor(RECIPES.pistola, qP, roundUp);

      const priceRes = computePrice(qF,qS,qP);

      const text = [
        '=== Resumo de fabrica√ß√£o (Jogo) ===',
        `${RECIPES.fuzil.label}: ${qF} unidades ‚Üí Cobre ${rF.cobre}, Alum√≠nio ${rF.alum}, P√≥lvora ${rF.pul}`,
        `${RECIPES.sub.label}: ${qS} unidades ‚Üí Cobre ${rS.cobre}, Alum√≠nio ${rS.alum}, P√≥lvora ${rS.pul}`,
        `${RECIPES.pistola.label}: ${qP} unidades ‚Üí Cobre ${rP.cobre}, Alum√≠nio ${rP.alum}, P√≥lvora ${rP.pul}`,
        '----------------------------------',
        `Totais ‚Üí Cobres: ${roundUp ? Math.ceil(rF.cobre + rS.cobre + rP.cobre) : (rF.cobre + rS.cobre + rP.cobre)}, Alum√≠nios: ${roundUp ? Math.ceil(rF.alum + rS.alum + rP.alum) : (rF.alum + rS.alum + rP.alum)}, P√≥lvoras: ${roundUp ? Math.ceil(rF.pul + rS.pul + rP.pul) : (rF.pul + rS.pul + rP.pul)}`,
        '--- CUSTOS ---',
        `Pre√ßo unit√°rio: Fuzil ${Number(priceInputs.fuzil.value || 0)}, Sub ${Number(priceInputs.sub.value || 0)}, Pistola ${Number(priceInputs.pistola.value || 0)}`,
        `Custos por tipo: Fuzil R$ ${priceRes.costF.toLocaleString('pt-BR')}, Sub R$ ${priceRes.costS.toLocaleString('pt-BR')}, Pistola R$ ${priceRes.costP.toLocaleString('pt-BR')}`,
        `Total geral: R$ ${priceRes.grand.toLocaleString('pt-BR')}`,
        '(Base: valores por 1000 unidades)'
      ].join('\\n');

      navigator.clipboard?.writeText(text).then(()=>{
        copyBtn.textContent = 'Copiado!';
        setTimeout(()=> copyBtn.textContent = 'Copiar resumo', 1400);
      }).catch(()=> {
        alert('Copiar falhou ‚Äî selecione e copie manualmente:\\n\\n' + text);
      });
    });

    // Price calc button
    calcPriceBtn.addEventListener('click', ()=>{
      const qF = Math.max(0, Math.floor(Number(fuzilQty.value) || 0));
      const qS = Math.max(0, Math.floor(Number(subQty.value) || 0));
      const qP = Math.max(0, Math.floor(Number(pistolaQty.value) || 0));
      computePrice(qF,qS,qP);
    });

    // Reset price inputs to defaults
    resetPriceBtn.addEventListener('click', ()=>{
      priceInputs.fuzil.value = 290;
      priceInputs.sub.value = 250;
      priceInputs.pistola.value = 150;
      // recalcula usando os pre√ßos resetados
      calcPriceBtn.click();
    });

    // calcular ao pressionar Enter nas quantidades
    [fuzilQty, subQty, pistolaQty].forEach(inp=>{
      inp.addEventListener('keydown', (e)=>{
        if(e.key === 'Enter'){ performCalc(); }
      });
    });

    // Inicial
    performCalc();
  </script>
</body>
</html>
